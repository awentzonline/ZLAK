!function(a,b,c,d){function e(a){c("#console").append("<div>"+a+"</div>")}function f(a){var b=a.peer;l[b]=a,a.on("data",function(a){switch(a.type){case"peers4u":var c=a.data;d.forEach(c,function(a){void 0===l[a]&&g(a)});break;case"chat":k(b,a.data)}}),a.on("open",function(){e(b+" opened"),h(b)}),a.on("close",function(){delete l[b],e(b+" closed")}),a.on("error",function(a){e(b+" error: "+a)})}function g(a){if(void 0===l[a]){var b=m.connect(a);f(b)}}function h(a){var b=l[a];if(b){var c=d.filter(d.keys(l),function(b){return b!=a});j(a,"peers4u",c)}}function i(a,b){var c={type:a,data:b};d(l).forEach(function(a){a.send(c)})}function j(a,b,c){var d={type:b,data:c},e=l[a];e.send(d)}function k(a,b){e(a+": "+b)}var l={},m=new Peer({key:"x6wcgg5nrtuzncdi",config:{iceServers:[{url:"stun://stun.l.google.com:19302"},{url:"stun://stun1.l.google.com:19302"},{url:"stun://stun2.l.google.com:19302"},{url:"stun://stun3.l.google.com:19302"},{url:"stun://stun4.l.google.com:19302"}]}});m.on("open",function(a){e("Your peer ID is: "+a)}),m.on("connection",f),m.on("error",function(a){e("Peer error: "+a)}),c(".add-peer-form").submit(function(a){a.preventDefault();var b=c(this),d=b.find(".peer-id");return g(d.val()),d.val(""),!1}),c(".chat-form").submit(function(a){a.preventDefault();var b=c(this),d=b.find(".chat-message"),e=d.val().trim();return e&&(k("You",e),i("chat",e)),d.val(""),!1})}(window,document,jQuery,_);